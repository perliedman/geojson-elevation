var test = require('tape'),
    addElevation = require('../').addElevation,
    TileSet = require('node-hgt').TileSet,
    coordReduce = require('@turf/meta').coordReduce;

test('can add elevation to LineString', function(t) {
    var lineString = {
            "type":"LineString",
            "coordinates":[[11.940062,57.739978],[11.940198,57.740008],[11.940376,57.740019],[11.940499,57.740034],[11.94034,57.740462],[11.940263,57.740733],[11.940146,57.74102],[11.940117,57.74109],[11.940027,57.741282],[11.939963,57.74142],[11.93995,57.741453],[11.940069,57.741426],[11.940246,57.741435],[11.940349,57.74137],[11.940405,57.741292],[11.94046,57.741148],[11.940554,57.740902],[11.940879,57.740109],[11.941093,57.739587],[11.941282,57.739079],[11.941497,57.738442],[11.941528,57.738356],[11.941651,57.738011],[11.941684,57.737903],[11.941806,57.737503],[11.941935,57.737021],[11.941969,57.736577],[11.941952,57.736169],[11.941917,57.73567],[11.9419,57.735235],[11.941813,57.734628],[11.941767,57.734312],[11.941732,57.734237],[11.941768,57.734189],[11.941826,57.734148],[11.94183,57.733996],[11.9419,57.733732],[11.941969,57.733493],[11.942072,57.733209],[11.942269,57.732928],[11.942364,57.732666],[11.942358,57.732564],[11.942388,57.732423],[11.942468,57.732276],[11.942516,57.732199],[11.942543,57.732111],[11.942541,57.732037],[11.942484,57.731985],[11.942478,57.731926],[11.942523,57.731871],[11.942581,57.731842],[11.94272,57.731821],[11.942836,57.731755],[11.943177,57.731486],[11.943544,57.731083],[11.943867,57.730707],[11.944051,57.730398],[11.944151,57.730235],[11.944254,57.730011],[11.944314,57.729905],[11.944434,57.729814],[11.944511,57.729717],[11.944597,57.729543],[11.944638,57.729477],[11.944726,57.729319],[11.944982,57.728911],[11.945331,57.728342],[11.94545,57.728094],[11.94563,57.727724],[11.945664,57.727653],[11.945713,57.727401],[11.945732,57.727343],[11.945632,57.72726],[11.945757,57.72721],[11.945759,57.727102],[11.94576,57.726992],[11.945723,57.726705],[11.945693,57.726582],[11.945671,57.726472],[11.945626,57.726297],[11.94562,57.726165],[11.945587,57.72595],[11.945541,57.725098],[11.945471,57.724524],[11.945453,57.724292],[11.94545,57.724228],[11.945431,57.723993],[11.945417,57.72386],[11.945416,57.723812],[11.945411,57.723674],[11.945371,57.723097],[11.945316,57.722452],[11.945273,57.721901],[11.945255,57.721785],[11.945257,57.721682],[11.945249,57.721527],[11.945237,57.721391],[11.945242,57.721131],[11.945244,57.721079],[11.945235,57.720857],[11.945228,57.720742],[11.945219,57.720542],[11.945209,57.720338],[11.945442,57.720353],[11.945833,57.720378],[11.946086,57.720394],[11.946873,57.720465],[11.947105,57.720491],[11.948119,57.72059],[11.949518,57.720609],[11.950047,57.720569],[11.95046,57.720528],[11.950855,57.720482],[11.951618,57.720345],[11.952013,57.720282],[11.952737,57.720178],[11.953311,57.720146],[11.953444,57.720145],[11.953727,57.720143],[11.954138,57.720155],[11.95466,57.720174],[11.955403,57.720213],[11.955851,57.720203],[11.956462,57.720189],[11.957834,57.720191],[11.958079,57.720207],[11.958782,57.720247],[11.959062,57.720258],[11.959278,57.720256],[11.95952,57.72024],[11.959956,57.720206],[11.960241,57.720164],[11.960692,57.72007],[11.961207,57.719974],[11.961843,57.719813],[11.962358,57.719625],[11.962577,57.719513],[11.962761,57.719394],[11.962868,57.719293],[11.963104,57.719043],[11.963303,57.718686],[11.963774,57.717803],[11.963848,57.717662],[11.963941,57.717484],[11.96407,57.717235],[11.96421,57.716967],[11.964397,57.716614],[11.964492,57.716438],[11.9646,57.716251],[11.964679,57.716147],[11.964775,57.716036],[11.964896,57.715927],[11.965038,57.715814],[11.965271,57.715648],[11.965654,57.715389],[11.967889,57.713836],[11.968645,57.713298],[11.96898,57.713049],[11.969117,57.712924],[11.969223,57.712817],[11.969342,57.71266],[11.969466,57.712433],[11.969565,57.712174],[11.969594,57.712057],[11.96962,57.711881],[11.969621,57.711764],[11.969609,57.711621],[11.969583,57.711477],[11.969504,57.711223],[11.969411,57.710944],[11.969362,57.710851],[11.969292,57.710782],[11.969188,57.71072],[11.969058,57.710671],[11.968813,57.710604],[11.96869,57.710577],[11.968308,57.710512],[11.968016,57.710469],[11.96781,57.710451],[11.967626,57.710458],[11.967511,57.710479],[11.967434,57.710517],[11.967385,57.710561],[11.967384,57.710642],[11.967484,57.710724],[11.967561,57.710767],[11.96773,57.71084],[11.967866,57.710877],[11.968087,57.710955],[11.968502,57.711102],[11.969511,57.711459],[11.969958,57.711607],[11.970051,57.711637],[11.970402,57.711753],[11.970506,57.711859],[11.970543,57.711916],[11.970538,57.712001],[11.970503,57.712088],[11.970385,57.712173],[11.970229,57.712226],[11.970108,57.712245],[11.969993,57.712249],[11.969866,57.712241],[11.969362,57.712048],[11.968935,57.711873],[11.968721,57.711691],[11.968197,57.711496],[11.967308,57.711154],[11.967216,57.711119],[11.966799,57.710902],[11.965442,57.710497],[11.964296,57.709811],[11.963489,57.708614],[11.962288,57.706009],[11.961998,57.705563],[11.961662,57.705168],[11.960911,57.704466],[11.960699,57.704258],[11.960461,57.704069],[11.960292,57.703958],[11.959712,57.703669],[11.958937,57.703293],[11.958558,57.703115],[11.958253,57.702958],[11.957732,57.702787],[11.956943,57.702553],[11.956134,57.702327],[11.955223,57.702098],[11.954288,57.701884],[11.95276,57.701727],[11.952053,57.701664],[11.951262,57.701633],[11.951104,57.701606],[11.950951,57.701601],[11.950816,57.701598],[11.950562,57.701578],[11.950582,57.701392],[11.950625,57.701266],[11.950659,57.701197],[11.9507,57.701115],[11.950761,57.70106],[11.95088,57.70096],[11.950945,57.700916],[11.951009,57.700859],[11.951227,57.700724],[11.951289,57.700686],[11.951393,57.700575],[11.951446,57.700487],[11.951642,57.700312],[11.951734,57.70024],[11.951794,57.700201],[11.951895,57.700135],[11.951991,57.700071],[11.952124,57.699671],[11.952144,57.699607],[11.952161,57.699539],[11.952147,57.699465],[11.952016,57.699174],[11.951795,57.69882],[11.951339,57.698119],[11.950953,57.697413],[11.950941,57.69736],[11.95095,57.697303],[11.95103,57.697086],[11.951088,57.696924],[11.951306,57.696324],[11.951345,57.696215],[11.951366,57.696159],[11.95148,57.695875],[11.951672,57.695405],[11.951858,57.694938],[11.951892,57.694856],[11.952097,57.694372],[11.952331,57.693777],[11.952363,57.69367],[11.952434,57.693436],[11.952455,57.693317],[11.952474,57.693187],[11.952481,57.693072],[11.952488,57.692952],[11.952496,57.692712],[11.952494,57.69262],[11.952485,57.692531],[11.95245,57.692367],[11.952436,57.692298],[11.952419,57.692212],[11.952367,57.692032],[11.952324,57.691909],[11.952167,57.691581],[11.952032,57.691307],[11.951933,57.691193],[11.951797,57.69103],[11.951668,57.690831],[11.951613,57.690698],[11.951606,57.690637],[11.95163,57.690568],[11.951693,57.690504],[11.951818,57.69044],[11.951926,57.690416],[11.952129,57.69039],[11.95228,57.690375],[11.952533,57.690352],[11.952816,57.690279],[11.952911,57.690235],[11.952939,57.690177],[11.953009,57.690116],[11.95311,57.690072],[11.953029,57.689827],[11.952822,57.688995],[11.952767,57.68882],[11.952706,57.688655],[11.952792,57.688078],[11.952912,57.687619],[11.952916,57.687448],[11.952921,57.687302],[11.952894,57.686978],[11.952821,57.686659],[11.952638,57.68631],[11.952294,57.685963],[11.951877,57.685533],[11.951692,57.685319],[11.951253,57.684867],[11.950807,57.684412],[11.950183,57.683839],[11.949419,57.683247],[11.949035,57.682955],[11.948615,57.682664],[11.947756,57.68217],[11.946139,57.681212],[11.945442,57.680804],[11.945358,57.680752],[11.945447,57.680717],[11.94607,57.680468],[11.946164,57.680431],[11.946219,57.680364],[11.946259,57.680316],[11.946688,57.680147],[11.947248,57.67994],[11.947889,57.679695],[11.948571,57.679448],[11.948491,57.67939],[11.94897,57.67921]]
        },
        tileSet = new TileSet(__dirname + '/data');

    addElevation(lineString, tileSet, function(err, data) {
        if (err) {
            t.fail(err);
            t.end();
            return;
        }

        var allCoordsHaveElevation = data.coordinates.reduce(function(a, c) {
            return a && c.length === 3 && c[2] != null;
        }, true);
        t.ok(allCoordsHaveElevation, 'all coordinates have elevation');
        t.end();
    });
});

test('can add elevation to LineString feature', function(t) {
    var lineString = {
            "type":"Feature",
            "properties":{},
            "geometry":{
                "type":"LineString",
                "coordinates":[[11.940062,57.739978],[11.940198,57.740008],[11.940376,57.740019],[11.940499,57.740034],[11.94034,57.740462],[11.940263,57.740733],[11.940146,57.74102],[11.940117,57.74109],[11.940027,57.741282],[11.939963,57.74142],[11.93995,57.741453],[11.940069,57.741426],[11.940246,57.741435],[11.940349,57.74137],[11.940405,57.741292],[11.94046,57.741148],[11.940554,57.740902],[11.940879,57.740109],[11.941093,57.739587],[11.941282,57.739079],[11.941497,57.738442],[11.941528,57.738356],[11.941651,57.738011],[11.941684,57.737903],[11.941806,57.737503],[11.941935,57.737021],[11.941969,57.736577],[11.941952,57.736169],[11.941917,57.73567],[11.9419,57.735235],[11.941813,57.734628],[11.941767,57.734312],[11.941732,57.734237],[11.941768,57.734189],[11.941826,57.734148],[11.94183,57.733996],[11.9419,57.733732],[11.941969,57.733493],[11.942072,57.733209],[11.942269,57.732928],[11.942364,57.732666],[11.942358,57.732564],[11.942388,57.732423],[11.942468,57.732276],[11.942516,57.732199],[11.942543,57.732111],[11.942541,57.732037],[11.942484,57.731985],[11.942478,57.731926],[11.942523,57.731871],[11.942581,57.731842],[11.94272,57.731821],[11.942836,57.731755],[11.943177,57.731486],[11.943544,57.731083],[11.943867,57.730707],[11.944051,57.730398],[11.944151,57.730235],[11.944254,57.730011],[11.944314,57.729905],[11.944434,57.729814],[11.944511,57.729717],[11.944597,57.729543],[11.944638,57.729477],[11.944726,57.729319],[11.944982,57.728911],[11.945331,57.728342],[11.94545,57.728094],[11.94563,57.727724],[11.945664,57.727653],[11.945713,57.727401],[11.945732,57.727343],[11.945632,57.72726],[11.945757,57.72721],[11.945759,57.727102],[11.94576,57.726992],[11.945723,57.726705],[11.945693,57.726582],[11.945671,57.726472],[11.945626,57.726297],[11.94562,57.726165],[11.945587,57.72595],[11.945541,57.725098],[11.945471,57.724524],[11.945453,57.724292],[11.94545,57.724228],[11.945431,57.723993],[11.945417,57.72386],[11.945416,57.723812],[11.945411,57.723674],[11.945371,57.723097],[11.945316,57.722452],[11.945273,57.721901],[11.945255,57.721785],[11.945257,57.721682],[11.945249,57.721527],[11.945237,57.721391],[11.945242,57.721131],[11.945244,57.721079],[11.945235,57.720857],[11.945228,57.720742],[11.945219,57.720542],[11.945209,57.720338],[11.945442,57.720353],[11.945833,57.720378],[11.946086,57.720394],[11.946873,57.720465],[11.947105,57.720491],[11.948119,57.72059],[11.949518,57.720609],[11.950047,57.720569],[11.95046,57.720528],[11.950855,57.720482],[11.951618,57.720345],[11.952013,57.720282],[11.952737,57.720178],[11.953311,57.720146],[11.953444,57.720145],[11.953727,57.720143],[11.954138,57.720155],[11.95466,57.720174],[11.955403,57.720213],[11.955851,57.720203],[11.956462,57.720189],[11.957834,57.720191],[11.958079,57.720207],[11.958782,57.720247],[11.959062,57.720258],[11.959278,57.720256],[11.95952,57.72024],[11.959956,57.720206],[11.960241,57.720164],[11.960692,57.72007],[11.961207,57.719974],[11.961843,57.719813],[11.962358,57.719625],[11.962577,57.719513],[11.962761,57.719394],[11.962868,57.719293],[11.963104,57.719043],[11.963303,57.718686],[11.963774,57.717803],[11.963848,57.717662],[11.963941,57.717484],[11.96407,57.717235],[11.96421,57.716967],[11.964397,57.716614],[11.964492,57.716438],[11.9646,57.716251],[11.964679,57.716147],[11.964775,57.716036],[11.964896,57.715927],[11.965038,57.715814],[11.965271,57.715648],[11.965654,57.715389],[11.967889,57.713836],[11.968645,57.713298],[11.96898,57.713049],[11.969117,57.712924],[11.969223,57.712817],[11.969342,57.71266],[11.969466,57.712433],[11.969565,57.712174],[11.969594,57.712057],[11.96962,57.711881],[11.969621,57.711764],[11.969609,57.711621],[11.969583,57.711477],[11.969504,57.711223],[11.969411,57.710944],[11.969362,57.710851],[11.969292,57.710782],[11.969188,57.71072],[11.969058,57.710671],[11.968813,57.710604],[11.96869,57.710577],[11.968308,57.710512],[11.968016,57.710469],[11.96781,57.710451],[11.967626,57.710458],[11.967511,57.710479],[11.967434,57.710517],[11.967385,57.710561],[11.967384,57.710642],[11.967484,57.710724],[11.967561,57.710767],[11.96773,57.71084],[11.967866,57.710877],[11.968087,57.710955],[11.968502,57.711102],[11.969511,57.711459],[11.969958,57.711607],[11.970051,57.711637],[11.970402,57.711753],[11.970506,57.711859],[11.970543,57.711916],[11.970538,57.712001],[11.970503,57.712088],[11.970385,57.712173],[11.970229,57.712226],[11.970108,57.712245],[11.969993,57.712249],[11.969866,57.712241],[11.969362,57.712048],[11.968935,57.711873],[11.968721,57.711691],[11.968197,57.711496],[11.967308,57.711154],[11.967216,57.711119],[11.966799,57.710902],[11.965442,57.710497],[11.964296,57.709811],[11.963489,57.708614],[11.962288,57.706009],[11.961998,57.705563],[11.961662,57.705168],[11.960911,57.704466],[11.960699,57.704258],[11.960461,57.704069],[11.960292,57.703958],[11.959712,57.703669],[11.958937,57.703293],[11.958558,57.703115],[11.958253,57.702958],[11.957732,57.702787],[11.956943,57.702553],[11.956134,57.702327],[11.955223,57.702098],[11.954288,57.701884],[11.95276,57.701727],[11.952053,57.701664],[11.951262,57.701633],[11.951104,57.701606],[11.950951,57.701601],[11.950816,57.701598],[11.950562,57.701578],[11.950582,57.701392],[11.950625,57.701266],[11.950659,57.701197],[11.9507,57.701115],[11.950761,57.70106],[11.95088,57.70096],[11.950945,57.700916],[11.951009,57.700859],[11.951227,57.700724],[11.951289,57.700686],[11.951393,57.700575],[11.951446,57.700487],[11.951642,57.700312],[11.951734,57.70024],[11.951794,57.700201],[11.951895,57.700135],[11.951991,57.700071],[11.952124,57.699671],[11.952144,57.699607],[11.952161,57.699539],[11.952147,57.699465],[11.952016,57.699174],[11.951795,57.69882],[11.951339,57.698119],[11.950953,57.697413],[11.950941,57.69736],[11.95095,57.697303],[11.95103,57.697086],[11.951088,57.696924],[11.951306,57.696324],[11.951345,57.696215],[11.951366,57.696159],[11.95148,57.695875],[11.951672,57.695405],[11.951858,57.694938],[11.951892,57.694856],[11.952097,57.694372],[11.952331,57.693777],[11.952363,57.69367],[11.952434,57.693436],[11.952455,57.693317],[11.952474,57.693187],[11.952481,57.693072],[11.952488,57.692952],[11.952496,57.692712],[11.952494,57.69262],[11.952485,57.692531],[11.95245,57.692367],[11.952436,57.692298],[11.952419,57.692212],[11.952367,57.692032],[11.952324,57.691909],[11.952167,57.691581],[11.952032,57.691307],[11.951933,57.691193],[11.951797,57.69103],[11.951668,57.690831],[11.951613,57.690698],[11.951606,57.690637],[11.95163,57.690568],[11.951693,57.690504],[11.951818,57.69044],[11.951926,57.690416],[11.952129,57.69039],[11.95228,57.690375],[11.952533,57.690352],[11.952816,57.690279],[11.952911,57.690235],[11.952939,57.690177],[11.953009,57.690116],[11.95311,57.690072],[11.953029,57.689827],[11.952822,57.688995],[11.952767,57.68882],[11.952706,57.688655],[11.952792,57.688078],[11.952912,57.687619],[11.952916,57.687448],[11.952921,57.687302],[11.952894,57.686978],[11.952821,57.686659],[11.952638,57.68631],[11.952294,57.685963],[11.951877,57.685533],[11.951692,57.685319],[11.951253,57.684867],[11.950807,57.684412],[11.950183,57.683839],[11.949419,57.683247],[11.949035,57.682955],[11.948615,57.682664],[11.947756,57.68217],[11.946139,57.681212],[11.945442,57.680804],[11.945358,57.680752],[11.945447,57.680717],[11.94607,57.680468],[11.946164,57.680431],[11.946219,57.680364],[11.946259,57.680316],[11.946688,57.680147],[11.947248,57.67994],[11.947889,57.679695],[11.948571,57.679448],[11.948491,57.67939],[11.94897,57.67921]]
            }
        },
        tileSet = new TileSet(__dirname + '/data');

    addElevation(lineString, tileSet, function(err, data) {
        if (err) {
            t.fail(err);
            t.end();
            return;
        }

        var allCoordsHaveElevation = data.geometry.coordinates.reduce(function(a, c) {
            return a && c.length === 3 && c[2] != null;
        }, true);
        t.ok(allCoordsHaveElevation, 'all coordinates have elevation');
        t.end();
    });
});

test('can add elevation to FeatureCollection', function(t) {
    var featureCollection = {"type":"FeatureCollection","features":[{"type":"Feature","properties":{"id":"waypoints","names":[null,null]},"geometry":{"type":"MultiPoint","coordinates":[[11.940062,57.739975],[11.94897,57.679207]]}},{"type":"Feature","properties":{"id":"line"},"geometry":{"type":"LineString","coordinates":[[11.940062,57.739978],[11.940198,57.740008],[11.940376,57.740019],[11.940499,57.740034],[11.94034,57.740462],[11.940263,57.740733],[11.940146,57.74102],[11.940117,57.74109],[11.940027,57.741282],[11.939963,57.74142],[11.93995,57.741453],[11.940069,57.741426],[11.940246,57.741435],[11.940349,57.74137],[11.940405,57.741292],[11.94046,57.741148],[11.940554,57.740902],[11.940879,57.740109],[11.941093,57.739587],[11.941282,57.739079],[11.941497,57.738442],[11.941528,57.738356],[11.941651,57.738011],[11.941684,57.737903],[11.941806,57.737503],[11.941935,57.737021],[11.941969,57.736577],[11.941952,57.736169],[11.941917,57.73567],[11.9419,57.735235],[11.941813,57.734628],[11.941767,57.734312],[11.941732,57.734237],[11.941768,57.734189],[11.941826,57.734148],[11.94183,57.733996],[11.9419,57.733732],[11.941969,57.733493],[11.942072,57.733209],[11.942269,57.732928],[11.942364,57.732666],[11.942358,57.732564],[11.942388,57.732423],[11.942468,57.732276],[11.942516,57.732199],[11.942543,57.732111],[11.942541,57.732037],[11.942484,57.731985],[11.942478,57.731926],[11.942523,57.731871],[11.942581,57.731842],[11.94272,57.731821],[11.942836,57.731755],[11.943177,57.731486],[11.943544,57.731083],[11.943867,57.730707],[11.944051,57.730398],[11.944151,57.730235],[11.944254,57.730011],[11.944314,57.729905],[11.944434,57.729814],[11.944511,57.729717],[11.944597,57.729543],[11.944638,57.729477],[11.944726,57.729319],[11.944982,57.728911],[11.945331,57.728342],[11.94545,57.728094],[11.94563,57.727724],[11.945664,57.727653],[11.945713,57.727401],[11.945732,57.727343],[11.945632,57.72726],[11.945757,57.72721],[11.945759,57.727102],[11.94576,57.726992],[11.945723,57.726705],[11.945693,57.726582],[11.945671,57.726472],[11.945626,57.726297],[11.94562,57.726165],[11.945587,57.72595],[11.945541,57.725098],[11.945471,57.724524],[11.945453,57.724292],[11.94545,57.724228],[11.945431,57.723993],[11.945417,57.72386],[11.945416,57.723812],[11.945411,57.723674],[11.945371,57.723097],[11.945316,57.722452],[11.945273,57.721901],[11.945255,57.721785],[11.945257,57.721682],[11.945249,57.721527],[11.945237,57.721391],[11.945242,57.721131],[11.945244,57.721079],[11.945235,57.720857],[11.945228,57.720742],[11.945219,57.720542],[11.945209,57.720338],[11.945442,57.720353],[11.945833,57.720378],[11.946086,57.720394],[11.946873,57.720465],[11.947105,57.720491],[11.948119,57.72059],[11.949518,57.720609],[11.950047,57.720569],[11.95046,57.720528],[11.950855,57.720482],[11.951618,57.720345],[11.952013,57.720282],[11.952737,57.720178],[11.953311,57.720146],[11.953444,57.720145],[11.953727,57.720143],[11.954138,57.720155],[11.95466,57.720174],[11.955403,57.720213],[11.955851,57.720203],[11.956462,57.720189],[11.957834,57.720191],[11.958079,57.720207],[11.958782,57.720247],[11.959062,57.720258],[11.959278,57.720256],[11.95952,57.72024],[11.959956,57.720206],[11.960241,57.720164],[11.960692,57.72007],[11.961207,57.719974],[11.961843,57.719813],[11.962358,57.719625],[11.962577,57.719513],[11.962761,57.719394],[11.962868,57.719293],[11.963104,57.719043],[11.963303,57.718686],[11.963774,57.717803],[11.963848,57.717662],[11.963941,57.717484],[11.96407,57.717235],[11.96421,57.716967],[11.964397,57.716614],[11.964492,57.716438],[11.9646,57.716251],[11.964679,57.716147],[11.964775,57.716036],[11.964896,57.715927],[11.965038,57.715814],[11.965271,57.715648],[11.965654,57.715389],[11.967889,57.713836],[11.968645,57.713298],[11.96898,57.713049],[11.969117,57.712924],[11.969223,57.712817],[11.969342,57.71266],[11.969466,57.712433],[11.969565,57.712174],[11.969594,57.712057],[11.96962,57.711881],[11.969621,57.711764],[11.969609,57.711621],[11.969583,57.711477],[11.969504,57.711223],[11.969411,57.710944],[11.969362,57.710851],[11.969292,57.710782],[11.969188,57.71072],[11.969058,57.710671],[11.968813,57.710604],[11.96869,57.710577],[11.968308,57.710512],[11.968016,57.710469],[11.96781,57.710451],[11.967626,57.710458],[11.967511,57.710479],[11.967434,57.710517],[11.967385,57.710561],[11.967384,57.710642],[11.967484,57.710724],[11.967561,57.710767],[11.96773,57.71084],[11.967866,57.710877],[11.968087,57.710955],[11.968502,57.711102],[11.969511,57.711459],[11.969958,57.711607],[11.970051,57.711637],[11.970402,57.711753],[11.970506,57.711859],[11.970543,57.711916],[11.970538,57.712001],[11.970503,57.712088],[11.970385,57.712173],[11.970229,57.712226],[11.970108,57.712245],[11.969993,57.712249],[11.969866,57.712241],[11.969362,57.712048],[11.968935,57.711873],[11.968721,57.711691],[11.968197,57.711496],[11.967308,57.711154],[11.967216,57.711119],[11.966799,57.710902],[11.965442,57.710497],[11.964296,57.709811],[11.963489,57.708614],[11.962288,57.706009],[11.961998,57.705563],[11.961662,57.705168],[11.960911,57.704466],[11.960699,57.704258],[11.960461,57.704069],[11.960292,57.703958],[11.959712,57.703669],[11.958937,57.703293],[11.958558,57.703115],[11.958253,57.702958],[11.957732,57.702787],[11.956943,57.702553],[11.956134,57.702327],[11.955223,57.702098],[11.954288,57.701884],[11.95276,57.701727],[11.952053,57.701664],[11.951262,57.701633],[11.951104,57.701606],[11.950951,57.701601],[11.950816,57.701598],[11.950562,57.701578],[11.950582,57.701392],[11.950625,57.701266],[11.950659,57.701197],[11.9507,57.701115],[11.950761,57.70106],[11.95088,57.70096],[11.950945,57.700916],[11.951009,57.700859],[11.951227,57.700724],[11.951289,57.700686],[11.951393,57.700575],[11.951446,57.700487],[11.951642,57.700312],[11.951734,57.70024],[11.951794,57.700201],[11.951895,57.700135],[11.951991,57.700071],[11.952124,57.699671],[11.952144,57.699607],[11.952161,57.699539],[11.952147,57.699465],[11.952016,57.699174],[11.951795,57.69882],[11.951339,57.698119],[11.950953,57.697413],[11.950941,57.69736],[11.95095,57.697303],[11.95103,57.697086],[11.951088,57.696924],[11.951306,57.696324],[11.951345,57.696215],[11.951366,57.696159],[11.95148,57.695875],[11.951672,57.695405],[11.951858,57.694938],[11.951892,57.694856],[11.952097,57.694372],[11.952331,57.693777],[11.952363,57.69367],[11.952434,57.693436],[11.952455,57.693317],[11.952474,57.693187],[11.952481,57.693072],[11.952488,57.692952],[11.952496,57.692712],[11.952494,57.69262],[11.952485,57.692531],[11.95245,57.692367],[11.952436,57.692298],[11.952419,57.692212],[11.952367,57.692032],[11.952324,57.691909],[11.952167,57.691581],[11.952032,57.691307],[11.951933,57.691193],[11.951797,57.69103],[11.951668,57.690831],[11.951613,57.690698],[11.951606,57.690637],[11.95163,57.690568],[11.951693,57.690504],[11.951818,57.69044],[11.951926,57.690416],[11.952129,57.69039],[11.95228,57.690375],[11.952533,57.690352],[11.952816,57.690279],[11.952911,57.690235],[11.952939,57.690177],[11.953009,57.690116],[11.95311,57.690072],[11.953029,57.689827],[11.952822,57.688995],[11.952767,57.68882],[11.952706,57.688655],[11.952792,57.688078],[11.952912,57.687619],[11.952916,57.687448],[11.952921,57.687302],[11.952894,57.686978],[11.952821,57.686659],[11.952638,57.68631],[11.952294,57.685963],[11.951877,57.685533],[11.951692,57.685319],[11.951253,57.684867],[11.950807,57.684412],[11.950183,57.683839],[11.949419,57.683247],[11.949035,57.682955],[11.948615,57.682664],[11.947756,57.68217],[11.946139,57.681212],[11.945442,57.680804],[11.945358,57.680752],[11.945447,57.680717],[11.94607,57.680468],[11.946164,57.680431],[11.946219,57.680364],[11.946259,57.680316],[11.946688,57.680147],[11.947248,57.67994],[11.947889,57.679695],[11.948571,57.679448],[11.948491,57.67939],[11.94897,57.67921]]}}]},
        tileSet = new TileSet(__dirname + '/data');

    addElevation(featureCollection, tileSet, function(err, data) {
        if (err) {
            t.fail(err);
            t.end();
            return;
        }

        var allCoordsHaveElevation = coordReduce(data, function(a, c) {
            return a && c.length === 3 && c[2] != null;
        }, true);
        t.ok(allCoordsHaveElevation, 'all coordinates have elevation');
        t.end();
    });
});
